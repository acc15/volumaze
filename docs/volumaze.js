!function(t){var n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(n){return t[n]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TWO_PI=2*Math.PI;var i=function(){function t(t,n){this.x=0,this.y=0,this.x=t,this.y=n}return t.prototype.add=function(n){var e=t.toPoint(n);return this.x+=e.x,this.y+=e.y,this},t.prototype.mul=function(n){var e=t.toPoint(n);return this.x*=e.x,this.y*=e.y,this},t.prototype.div=function(n){var e=t.toPoint(n);return this.x/=e.x,this.y/=e.y,this},t.prototype.center=function(){return this.div(2)},t.prototype.copy=function(){return new t(this.x,this.y)},t.prototype.normSquare=function(){return this.x*this.x+this.y*this.y},t.prototype.norm=function(){return Math.sqrt(this.normSquare())},t.prototype.normalize=function(){return 0===this.x&&0===this.y?this:this.div(this.norm())},t.prototype.polar=function(){var t=Math.sin(this.x)*this.y;return this.x=Math.cos(this.x)*this.y,this.y=t,this},t.toPoint=function(n){return"number"==typeof n?new t(n,n):Array.isArray(n)?new t(n[0],n[1]):n},t}();n.Point=i;var r=function(){function t(t,n){this.min=t,this.max=n}return t.prototype.length=function(){return this.max-this.min},t.prototype.offset=function(t){return this.min+=t,this.max+=t,this},t.prototype.step=function(){return this.offset(this.length())},t.prototype.center=function(){return(this.min+this.max)/2},t.prototype.copy=function(){return new t(this.min,this.max)},t.prototype.between=function(t){return t>=this.min&&t<this.max},t.prototype.inflate=function(t){return this.min-=t,this.max+=t,this},t.prototype.deflate=function(t){return this.inflate(-t)},t.prototype.makeInside=function(t){return Math.min(Math.max(t,this.min),this.max)},t.prototype.normalize=function(t){return(t-this.min)/this.length()},t.byStep=function(n,e){return new t(n,n+e)},t}();n.Range=r},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(2),r=e(4),o=e(0);e(5);var a=document.getElementById("maze"),u=i.generateMaze(24,24,new o.Range(30,Math.min(a.width,a.height)/2)),s={},c=5,f=u.rings[0][0],l=new o.Point(f.angle.center(),f.radius.center()),h=document.getElementById("audio");function y(t){return t.length>0?t.substring(0,1).toUpperCase()+t.substring(1):t}h.volume=0,h.play().then(function(){return console.log("Playing")},function(t){return console.error(t)}),["up","down","left","right"].forEach(function(t){var n=document.getElementById("key-"+t);n.ontouchstart=n.onmousedown=function(){s["Arrow"+y(t)]=!0},n.ontouchend=n.onmouseleave=n.onmouseup=function(){s["Arrow"+y(t)]=!1}}),window.onkeydown=function(t){s[t.key]=!0},window.onkeyup=function(t){delete s[t.key]};setInterval(function(){var t=new o.Point(s.ArrowRight?1:s.ArrowLeft?-1:0,s.ArrowUp?1:s.ArrowDown?-1:0).normalize().mul(1).div([l.y>0?l.y:1,1]);l.add(t);var n=u.radius.copy().deflate(c);l.y=n.makeInside(l.y);var e=Math.acos(1-c*c/(2*l.y*l.y)),i=f.getFirstLinkAt(1),r=f.getFirstLinkAt(0);i&&i.info.wall&&l.x+e>=f.angle.max?l.x=f.angle.max-e:r&&r.info.wall&&l.x-e<f.angle.min&&(l.x=f.angle.min+e),l.x>=f.angle.max&&i?f=i.to:l.x<f.angle.min&&r&&(f=r.to);var a=(f.directions[2]||[]).filter(function(t){return t.to.angle.between(l.x)})[0],y=f.getFirstLinkAt(3);a&&a.info.wall&&l.y+c>=f.radius.max?l.y=f.radius.max-c:y&&y.info.wall&&l.y-c<f.radius.min&&(l.y=f.radius.min+c),l.y>=f.radius.max&&a?f=a.to:l.y<f.radius.min&&y&&(f=y.to),l.x=(l.x+o.TWO_PI)%o.TWO_PI,h.volume=n.normalize(l.y)},1e3/60),requestAnimationFrame(function t(){requestAnimationFrame(t),n=document.getElementById("maze"),e=n.getContext("2d"),e&&function(t,n){t.clearRect(0,0,n.x,n.y);var e=n.copy().center();r.drawMaze(t,u,e),function(t,n,e){t.beginPath();var i=n.copy().add(e.copy().polar());t.fillStyle="#ff0000",t.arc(i.x,i.y,5,0,2*Math.PI),t.fill()}(t,e,l)}(e,new o.Point(n.width,n.height));var n,e})},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(3),r=e(0);function o(t){return(t+1)%2+2*Math.floor(t/2)}n.oppositeDirection=o;var a=function(){function t(t,n){this.visited=!1,this.directions={},this.radius=t,this.angle=n}return t.prototype.linkTo=function(t,n){if(!n)return this;var e={wall:!0};return this.getLinksTo(t).push({info:e,to:n}),n.getLinksTo(o(t)).push({info:e,to:this}),this},t.prototype.getLinksTo=function(t){return this.directions[t]||(this.directions[t]=[]),this.directions[t]},t.prototype.getFirstLinkAt=function(t){var n=this.directions[t];return n&&n.length?n[0]:void 0},t.prototype.getFirstNodeAt=function(t){var n=this.getFirstLinkAt(t);return n?n.to:void 0},t}();function u(t,n,e,i){for(var o=[],u=new r.Range(0,2*Math.PI/t),s=0;s<t;s++)i&&s>0&&s%n==0&&(i=i.getFirstNodeAt(1)),o.push(new a(e.copy(),u.copy()).linkTo(3,i).linkTo(0,s>0?o[s-1]:void 0)),u.step();return o.length>0&&o[0].linkTo(0,o[t-1]),o}function s(t,n,e){for(var i=[],o=r.Range.byStep(e.min,e.length()/t),a=4*Math.ceil(r.TWO_PI*o.max/n/4),s=0;s<t;s++){var c=1;r.TWO_PI*o.max/a>n&&(a*=2,c=2),i.push(u(a,c,o,s>0?i[s-1][0]:void 0)),o.step()}return{rings:i,radius:e}}n.MazeNode=a,n.makeMazeRing=u,n.makeMazeRings=s,n.generateMaze=function(t,n,e){var r=s(t,n,e);return i.backtraceCarve([r.rings[0][0]]),r}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.backtraceCarve=function(t){for(var n=function(){var n=t[t.length-1];n.visited=!0;var e=Object.keys(n.directions).flatMap(function(t){return n.directions[t]}).filter(function(t){return!t.to.visited});if(0===e.length)return t.pop(),"continue";var i=e[Math.floor(Math.random()*e.length)];i.info.wall=!1,t.push(i.to)};t.length>0;)n()}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(0);n.drawMaze=function(t,n,e){t.beginPath(),t.strokeStyle="black",t.arc(e.x,e.y,n.radius.min,0,2*Math.PI),t.stroke(),t.beginPath(),t.strokeStyle="black",t.arc(e.x,e.y,n.radius.max,0,2*Math.PI),t.stroke(),n.rings.flatMap(function(t){return t}).forEach(function(n){return function(t,n,e){var r=n.getFirstLinkAt(1),o=n.getFirstLinkAt(3);!function(t,n,e,r,o){if(r){var a=new i.Point(Math.cos(e.angle.max),Math.sin(e.angle.max)),u=n.copy().add(a.copy().mul(e.radius.min)),s=n.copy().add(a.copy().mul(e.radius.max));t.beginPath(),t.strokeStyle=r,t.moveTo(u.x,u.y),t.lineTo(s.x,s.y),t.stroke()}o&&(t.beginPath(),t.strokeStyle=o,t.arc(n.x,n.y,e.radius.min,e.angle.min,e.angle.max),t.stroke())}(t,e,n,r&&r.info.wall?"black":"",o&&o.info.wall?"black":"")}(t,n,e)})}},function(t,n,e){}]);
//# sourceMappingURL=volumaze.js.map